---
phase: 09-financial-pages
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - mockups/web-tms-redesign/billing.html
autonomous: false

must_haves:
  truths:
    - "Billing page has 3 segmented pill-style tabs: Overview, Brokers, Invoices"
    - "Overview tab shows Needs Invoice alert banner (orange) with count and amount when applicable"
    - "Overview tab shows 6 summary stat cards with colored dots — Total Invoiced (purple), Total Paid (green), Outstanding (blue), Overdue (red), Avg Days to Pay (amber), Collection Rate (color-coded)"
    - "Overview tab shows 5-color aging analysis bar (green/yellow/orange/red/dark-red) with amounts per bucket"
    - "Brokers tab shows broker table with mini aging bars (120px, 5-color, 8px height) per row"
    - "Invoices tab shows filter pills with counts and dot indicators, plus full invoice table with 4-state status badges (Needs Invoice/Invoiced/Paid/Overdue)"
    - "Stat cards are clickable where production has filtering behavior (visual cursor pointer + hover state)"
    - "Light/dark theme toggle works correctly on all 3 tabs"
  artifacts:
    - path: "mockups/web-tms-redesign/billing.html"
      provides: "Complete billing/receivables page with 3 tabs"
      min_lines: 800
  key_links:
    - from: "billing.html"
      to: "shared.css"
      via: "link rel stylesheet"
      pattern: 'href="./shared.css"'
    - from: "billing.html"
      to: "base-template.html"
      via: "copied app shell (sidebar + header + page-content)"
      pattern: "class=\"app-layout\""
---

<objective>
Create the Billing (Receivables) mockup page with 3 segmented tabs — Overview (alert banner, stat cards, aging bar, top brokers), Brokers (search, broker table with mini aging bars), and Invoices (filter pills, invoice table with status badges) — all with realistic sample data.

Purpose: Billing is the primary accounts receivable page where dispatchers track invoicing and payment status across brokers. The aging visualization (both full-width and per-broker mini bars) is a key UX element for identifying overdue payments. All 3 tabs must be fully rendered with interactive tab switching.

Output: `mockups/web-tms-redesign/billing.html` — standalone HTML file with all 3 tabs visible (JavaScript tab switching).
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-financial-pages/09-RESEARCH.md
@mockups/web-tms-redesign/shared.css
@mockups/web-tms-redesign/base-template.html
@mockups/web-tms-redesign/trips.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create billing.html with Overview, Brokers, and Invoices tabs</name>
  <files>mockups/web-tms-redesign/billing.html</files>
  <action>
Create `billing.html` by copying the app shell from `base-template.html`. Set title to "Horizon Star TMS -- Billing" and mark the Billing/Receivables nav item as `active`.

Inside `<div class="page-content">`, build the complete billing page with JavaScript tab switching (show/hide tab content divs). Default to Overview tab active.

**IMPORTANT CONSTRAINTS (from user decisions):**
- Segmented pill-style tab bar for the 3 tabs (matching production)
- 5-color aging gradient: Green (Current) → Yellow (1-30) → Orange (31-60) → Red (61-90) → Dark Red (90+)
- Mini aging bars (120px, 8px height) per broker row
- Stat cards use colored-dot indicator style (8px circle)
- Clickable stat cards with cursor:pointer and hover state where production has filtering
- Alert/action banners included (Needs Invoice warning)
- Green positive, red negative, ($X) accounting parentheses
- Monospace for monetary values in tables

---

## PAGE HEADER

- Title: "Receivables" with receipt icon
- Subtitle (text-secondary): "Manage invoices, track payments, monitor aging by broker"
- Right: "Export" button (btn-secondary, printer icon)

## TAB BAR

Segmented pill-style tab bar:
- `display: inline-flex; background: var(--bg-elevated); border-radius: var(--radius); padding: 3px; gap: 2px;`
- 3 tabs: "Overview" (active default), "Brokers", "Invoices"
- Active: `background: var(--bg-card); color: var(--text-primary); box-shadow: var(--shadow-card);`
- JavaScript onclick toggles active class and shows/hides corresponding tab content divs

---

## TAB 1: OVERVIEW

**1A. Needs Invoice Alert Banner**
- Amber-dim background, border-left 3px solid var(--amber), padding 16px
- Warning icon + "3 orders ready to invoice ($4,850.00)" (bold)
- "Create Invoices" button (btn-primary btn-sm)

**1B. Summary Stat Cards (6 cards, grid)**
Use `grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px;`
Each card: colored dot (8px) + label + large value. Cards 1-4 get `cursor: pointer` and hover shadow.

1. Total Invoiced: purple dot, "$142,680.00"
2. Total Paid: green dot, "$98,450.00"
3. Outstanding: blue dot, "$44,230.00"
4. Overdue: red dot, "$18,720.00"
5. Avg Days to Pay: amber dot, "24 days" (not clickable)
6. Collection Rate: green dot (since 69% rounds to ~70%), "69%" — color logic: green ≥70%, amber ≥50%, red <50%. At 69% this should show amber.

**1C. Aging Analysis Section**
- Section card with header: "Aging Analysis" + dollar-sign icon
- Large aging bar (full width, height 32px, border-radius 6px, overflow hidden):
  - Current (0 days): green #22c55e — 35% width
  - 1-30 days: yellow #eab308 — 25% width
  - 31-60 days: orange #f97316 — 18% width
  - 61-90 days: red #ef4444 — 14% width
  - 90+ days: dark red #dc2626 — 8% width
  - Each segment shows percentage text inside if wide enough

- Below bar: 5-column grid showing per-bucket details:
  - Current: $15,482.00 (green text)
  - 1-30 days: $11,057.50 (yellow/amber text)
  - 31-60 days: $7,961.40 (orange text)
  - 61-90 days: $6,192.20 (red text)
  - 90+ days: $3,536.90 (dark red text)

**1D. Top Brokers by Outstanding**
- Section card with header: "Top Brokers by Outstanding" + "View All" button (links to Brokers tab)
- Simple table, 4 columns: Broker | Outstanding | Invoices | Overdue
- 5 rows:
  1. Central Dispatch | $12,450.00 | 8 | 3
  2. Super Dispatch | $9,280.00 | 6 | 2
  3. LoadMax | $8,100.00 | 5 | 2
  4. Ship.Cars | $5,400.00 | 4 | 1
  5. QuickShip Transport | $3,200.00 | 3 | 0

---

## TAB 2: BROKERS (initially hidden)

**2A. Search Box**
- Full-width search input: placeholder "Search brokers..."
- Standard input styling from shared.css

**2B. Broker Table**
- Table wrapper with standard styling
- 8 columns: Broker Name | Total Invoiced | Paid | Outstanding | Overdue | Aging | Avg Days | Actions
- 5 data rows with realistic data:

Row 1 - Central Dispatch:
- $48,200.00 | $35,750.00 (green) | $12,450.00 (blue) | 3 (badge-red) | mini aging bar | 22 days | "View Invoices" btn-sm

Row 2 - Super Dispatch:
- $38,600.00 | $29,320.00 (green) | $9,280.00 (blue) | 2 (badge-red) | mini aging bar | 28 days | btn-sm

Row 3 - LoadMax:
- $27,400.00 | $19,300.00 (green) | $8,100.00 (blue) | 2 (badge-red) | mini aging bar | 35 days | btn-sm

Row 4 - Ship.Cars:
- $18,880.00 | $13,480.00 (green) | $5,400.00 (blue) | 1 (badge-amber) | mini aging bar | 19 days | btn-sm

Row 5 - QuickShip Transport:
- $9,600.00 | $6,400.00 (green) | $3,200.00 (blue) | 0 | mini aging bar | 15 days | btn-sm

**Mini Aging Bar:** (per row)
- Width 120px, height 8px, border-radius 4px, overflow hidden
- Same 5-color scheme as main bar
- Use inline styles for segment widths (each row has different distribution)
- Row 1: 20% current, 25% 1-30, 20% 31-60, 20% 61-90, 15% 90+
- Row 2: 30% current, 30% 1-30, 25% 31-60, 10% 61-90, 5% 90+
- Row 3: 15% current, 20% 1-30, 25% 31-60, 25% 61-90, 15% 90+
- Row 4: 40% current, 35% 1-30, 15% 31-60, 10% 61-90, 0% 90+
- Row 5: 60% current, 30% 1-30, 10% 31-60, 0% 61-90, 0% 90+

---

## TAB 3: INVOICES (initially hidden)

**3A. Filter Pills** (segmented pill-style, inline-flex row)
- All (18) — active by default
- Needs Invoice (3) — with amber dot indicator (8px circle)
- Outstanding (7)
- Paid (6)
- Overdue (2) — with red dot indicator

**3B. Search Box**
- Placeholder: "Search by order #, broker, vehicle..."

**3C. Invoice Table**
- 9 columns: Invoice # | Date | Broker | Order # | Vehicle | Amount | Days | Status | Actions
- Actions column sticky right
- 8 data rows demonstrating all 4 statuses:

Row 1 (Needs Invoice):
- — | Feb 3, 2026 | Central Dispatch | ORD-1052 | 2024 BMW X5 | $2,400.00 | — | badge-amber "NEEDS INVOICE" | "Create Invoice" btn-sm

Row 2 (Needs Invoice):
- — | Feb 1, 2026 | LoadMax | ORD-1050 | 2025 Audi Q7 | $1,250.00 | — | badge-amber "NEEDS INVOICE" | "Create Invoice" btn-sm

Row 3 (Needs Invoice):
- — | Jan 30, 2026 | Super Dispatch | ORD-1048 | 2023 Honda CR-V | $1,200.00 | — | badge-amber "NEEDS INVOICE" | "Create Invoice" btn-sm

Row 4 (Invoiced / Outstanding):
- INV-2026-089 | Jan 22, 2026 | Central Dispatch | ORD-1042 | 2024 Mercedes GLE | $2,800.00 | 18 days (blue text) | badge-blue "INVOICED" | "Mark Paid" btn-sm

Row 5 (Overdue):
- INV-2026-074 | Dec 28, 2025 | LoadMax | ORD-1035 | 2023 Toyota Camry | $1,650.00 | 43 days (red text, bold) | badge-red "OVERDUE" | "Mark Paid" btn-sm

Row 6 (Overdue):
- INV-2026-061 | Nov 15, 2025 | Ship.Cars | ORD-1028 | 2024 Tesla Model 3 | $3,200.00 | 86 days (red text, bold) | badge-red "OVERDUE" | "Mark Paid" btn-sm

Row 7 (Paid):
- INV-2026-082 | Jan 10, 2026 | Central Dispatch | ORD-1038 | 2025 Ford Bronco | $1,950.00 | — | badge-green "PAID" | "View" btn-sm

Row 8 (Paid):
- INV-2026-078 | Jan 5, 2026 | Super Dispatch | ORD-1034 | 2024 Chevy Tahoe | $2,100.00 | — | badge-green "PAID" | "View" btn-sm

**Styling notes:**
- Page-specific CSS in `<style>` tag for: tab bar, aging bar segments, mini aging bars, filter pills with dot indicators, clickable stat cards. Keep under 120 lines.
- Tab switching JavaScript: Simple onclick handler that toggles `.active` on tab buttons and shows/hides content divs using `display: none/block`.
- Aging bar segments: Use `display: flex` with percentage widths, each segment has its color as background.
- Mini aging bars: Same flex approach but 120px wide, 8px tall.
- Days column: Use conditional text coloring — blue for outstanding (< 30), orange for 31-60, red for overdue (> 60).
- Status badges: Use badge classes from shared.css (badge-amber, badge-blue, badge-green, badge-red).
  </action>
  <verify>
Open `mockups/web-tms-redesign/billing.html` in a browser. Verify:
1. Page loads without console errors
2. Header shows "Receivables" title with subtitle and Export button
3. Segmented pill tab bar with 3 tabs (Overview active by default)
4. OVERVIEW TAB: Orange Needs Invoice alert with count and amount
5. OVERVIEW TAB: 6 stat cards with colored dots (purple, green, blue, red, amber, amber/green)
6. OVERVIEW TAB: Full-width 5-color aging bar with percentage segments
7. OVERVIEW TAB: 5-column aging breakdown with amounts below bar
8. OVERVIEW TAB: Top brokers table with 5 rows
9. Click Brokers tab — content switches
10. BROKERS TAB: Search box and 5-row broker table
11. BROKERS TAB: Each row has a mini aging bar (120px, 5-color, 8px height)
12. Click Invoices tab — content switches
13. INVOICES TAB: Filter pills with counts and dot indicators (amber for Needs Invoice, red for Overdue)
14. INVOICES TAB: 8-row table showing all 4 statuses (Needs Invoice, Invoiced, Overdue, Paid)
15. Theme toggle works on all 3 tabs
  </verify>
  <done>billing.html exists with 3 segmented tabs (Overview with alert/stats/aging/brokers, Brokers with search/table/mini-aging-bars, Invoices with filter-pills/invoice-table/4-status-badges), tab switching JavaScript, colored-dot stat cards, 5-color aging bars, and working theme toggle</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Billing (Receivables) mockup with 3 segmented pill tabs — Overview (Needs Invoice alert, 6 stat cards with colored dots, 5-color aging bar with amounts, top brokers table), Brokers (search box, broker table with mini aging bars per row), and Invoices (filter pills with dot indicators, 8-row invoice table with all 4 status badges). JavaScript tab switching included.</what-built>
  <how-to-verify>
1. Open `mockups/web-tms-redesign/billing.html` in your browser
2. Verify segmented pill tab bar with 3 tabs
3. OVERVIEW: Check orange Needs Invoice alert banner (3 orders, $4,850.00)
4. OVERVIEW: Verify 6 stat cards with colored dots and correct values
5. OVERVIEW: Verify 5-color aging bar with visible percentage segments
6. OVERVIEW: Check 5-column breakdown amounts below the bar
7. OVERVIEW: Check top brokers table (5 rows with Outstanding/Invoices/Overdue)
8. Click "Brokers" tab — verify tab content switches
9. BROKERS: Verify search box and 5-row table with mini aging bars
10. BROKERS: Check mini bars have correct 5-color segments (120px wide, 8px tall)
11. Click "Invoices" tab — verify tab content switches
12. INVOICES: Check filter pills with counts and dot indicators
13. INVOICES: Verify 8-row table with all 4 statuses (3 Needs Invoice, 1 Invoiced, 2 Overdue, 2 Paid)
14. INVOICES: Check Days column color coding (blue outstanding, red overdue)
15. Toggle dark/light theme — all tabs should look clean
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- [ ] billing.html loads in browser without console errors
- [ ] Header: "Receivables" title, subtitle, Export button
- [ ] Segmented pill tab bar with 3 tabs, JavaScript switching works
- [ ] Overview: Orange Needs Invoice alert banner with count and create button
- [ ] Overview: 6 stat cards with colored dots (4 clickable with pointer cursor)
- [ ] Overview: Full-width 5-color aging bar (green/yellow/orange/red/dark-red)
- [ ] Overview: 5-column amounts below aging bar
- [ ] Overview: Top brokers table with 5 rows
- [ ] Brokers: Search input at top
- [ ] Brokers: 5-row table with mini aging bars (120px, 8px, 5-color)
- [ ] Brokers: Overdue column shows count badges
- [ ] Invoices: Filter pills with counts, amber/red dot indicators
- [ ] Invoices: 8-row table with all 4 status badges
- [ ] Invoices: Days column color-coded (blue < 30, red > 60)
- [ ] Invoices: Actions column sticky right
- [ ] All money in monospace, green positive, red negative with ($) format
- [ ] Theme toggle works on all tabs
- [ ] shared.css referenced, minimal page-specific CSS
</verification>

<success_criteria>
Billing mockup faithfully reproduces the production receivables page with 3 segmented tabs, all stat cards, the 5-color aging visualization (both full-width and per-broker mini bars), Needs Invoice alert, filter pills, invoice status badges, and tab switching, using Phase 6 design system with colored-dot indicators and working light/dark toggle.
</success_criteria>

<output>
After completion, create `.planning/phases/09-financial-pages/09-02-SUMMARY.md`
</output>
