---
phase: 10-operations-admin-pages
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - mockups/web-tms-redesign/fuel.html
  - mockups/web-tms-redesign/ifta.html
autonomous: false

must_haves:
  truths:
    - "Fuel page has 4 analytics tabs: Overview, Analytics, Efficiency, Price Analysis — all fully populated with realistic mock data"
    - "Fuel page shows Samsara mileage status card in 'data uploaded' state (blue banner with truck count + total miles)"
    - "Fuel page shows filter row with truck/state/product/driver dropdowns and stat cards: Total Diesel, Diesel Cost, Avg $/Gallon, Total Savings, Total DEF, Total Cost"
    - "Fuel page includes truck drill-down view (per-truck filtered state with 'Back to All Trucks' button)"
    - "Fuel Efficiency tab shows Miles Traveled (Samsara source), MPG, Cost Per Mile, Fill-Ups, Avg Gal/Fill-Up, Avg Discount/Gal"
    - "IFTA page shows full data state with uploaded mileage — IFTA calculation table with ~10 states"
    - "IFTA has exact columns: State, Miles, % of Miles, Taxable Gal, Fuel Purchased, Net Taxable, Tax Rate, Tax Due"
    - "IFTA shows summary stats: Total Miles, Fleet MPG, Taxable Gallons, Fuel Purchased, Tax Owed, Tax Credit, Net Tax Due"
    - "IFTA shows Quarter/Year selector and Fleet MPG input with auto-calculated MPG info box (blue banner)"
    - "IFTA shows fuel-by-state table with gallons purchased"
    - "Light/dark theme toggle works on both pages"
  artifacts:
    - path: "mockups/web-tms-redesign/fuel.html"
      provides: "Complete fuel tracking page with 4 analytics tabs and drill-down"
      min_lines: 800
    - path: "mockups/web-tms-redesign/ifta.html"
      provides: "Complete IFTA page with state mileage table and tax calculations"
      min_lines: 500
  key_links:
    - from: "fuel.html"
      to: "shared.css"
      via: "link rel stylesheet"
      pattern: 'href="./shared.css"'
    - from: "ifta.html"
      to: "shared.css"
      via: "link rel stylesheet"
      pattern: 'href="./shared.css"'
    - from: "fuel.html"
      to: "base-template.html"
      via: "copied app shell (sidebar + header + page-content)"
      pattern: "class=\"app-layout\""
    - from: "ifta.html"
      to: "base-template.html"
      via: "copied app shell (sidebar + header + page-content)"
      pattern: "class=\"app-layout\""
---

<objective>
Create Fuel Tracking and IFTA mockup pages — two related fuel data pages. Fuel is one of the most data-rich pages in the TMS (~250 lines of production rendering) with 4 analytics tabs, Samsara integration status, filter controls, 6 stat cards, and truck drill-down. IFTA shows state-by-state mileage breakdown with exact tax calculation columns.

Purpose: These pages demonstrate the full depth of fuel operations tracking — from individual fill-up transactions to fleet-wide efficiency metrics and state tax calculations.

Output: `mockups/web-tms-redesign/fuel.html` and `mockups/web-tms-redesign/ifta.html` — two standalone HTML files.
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-operations-admin-pages/10-CONTEXT.md
@.planning/phases/10-operations-admin-pages/10-RESEARCH.md
@mockups/web-tms-redesign/shared.css
@mockups/web-tms-redesign/base-template.html
@mockups/web-tms-redesign/financials.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create fuel.html with 4 analytics tabs and drill-down</name>
  <files>mockups/web-tms-redesign/fuel.html</files>
  <action>
Create `fuel.html` by copying the app shell from `base-template.html`. Set title to "Horizon Star TMS — Fuel Tracking" and mark the Fuel nav item as `active`.

Inside `<div class="page-content">`, build the complete fuel tracking page with JavaScript tab switching across 4 analytics tabs. Default to Overview tab active.

**Reference production structure (lines 19848-20097 of index.html) for layout fidelity.**

---

## PAGE HEADER

- Title: "Fuel Tracking" with fuel icon
- Right side: "Add Fuel Record" button (btn btn-primary) and "Upload Mileage" button (btn btn-secondary)

## SAMSARA MILEAGE STATUS CARD

Blue info banner (use blue-dim background, blue border):
- Icon: truck icon
- "Samsara Mileage Data Uploaded" (bold)
- "4 trucks • 245,680 total miles • Last updated: Jan 28, 2026"
- Right side: "Refresh Data" button (small, outline)

## FILTER ROW

Horizontal flex row with 4 filter dropdowns (styled selects):
1. Truck: "All Trucks" (default), T-101, T-102, T-103, T-104
2. State: "All States" (default), NJ, NY, PA, FL, GA, SC, NC, VA, MD
3. Product: "All Products" (default), Diesel, DEF
4. Driver: "All Drivers" (default), John Smith, Maria Garcia, David Chen, Sarah Johnson

## STAT CARDS (6 cards)

Grid: `repeat(auto-fit, minmax(180px, 1fr)); gap: 16px;`
Each card: bg-card, padding 16px, border-radius, colored left border

1. Total Diesel: green border, "18,420 gal" (large, bold), fuel-pump icon
2. Diesel Cost: red border, "$64,470.00" (large, monospace), dollar-sign icon
3. Avg $/Gallon: amber border, "$3.50" (large, monospace), tag icon
4. Total Savings: green border, "$2,840.00" (large, green, monospace), trending-down icon
5. Total DEF: blue border, "1,240 gal" (large, bold), droplet icon
6. Total Cost: red border, "$68,350.00" (large, monospace), receipt icon

## TAB BAR (4 tabs)

Segmented pill-style tab bar (same pattern as financials.html):
- 4 tabs: "Overview" (active), "Analytics", "Efficiency", "Price Analysis"
- JavaScript onclick toggles tabs

---

## TAB 1: OVERVIEW (default active)

**Fuel Transaction Table**
- Columns: Date | Truck | Driver | Location | State | Product | Gallons | PPG | Total | Discount | Card
- Sort indicators on all columns
- 20+ rows of realistic fuel transaction data:
  - Mix of Diesel and DEF products
  - Various states (NJ, NY, PA, FL, GA, SC, NC, VA)
  - Truck stops: Pilot, Love's, TA, Flying J, Sheetz, Wawa, BP
  - Card types: WEX, Comdata, EFS
  - Prices: Diesel $3.29-$3.89/gal, DEF $2.89-$3.19/gal
  - Discounts: $0.02-$0.08/gal
  - Dates spanning Jan 2026 (newest first)
- Each row: `<tr>` with standard table styling
- Pagination: "Showing 1-20 of 87 records" with prev/next buttons

---

## TAB 2: ANALYTICS (initially hidden)

**Monthly Fuel Spend Chart (CSS bar chart)**
- Title: "Monthly Fuel Spend"
- 6 bars representing Jul-Dec 2025 + Jan 2026
- CSS-based bars (vertical, using div heights):
  - Jul: $8,200 (60%), Aug: $9,100 (66%), Sep: $8,800 (64%), Oct: $9,400 (68%), Nov: $10,200 (74%), Dec: $11,400 (83%), Jan 2026: $11,650 (85%)
- Bar labels below, values on hover or above bars
- Use var(--green) for bars

**State Distribution Table**
- Title: "Fuel Purchases by State"
- Columns: State | Gallons | Amount | % of Total | Avg PPG
- 8 state rows:
  1. New Jersey | 4,200 gal | $14,700 | 21.5% | $3.50
  2. Florida | 3,800 gal | $13,680 | 20.0% | $3.60
  3. New York | 3,100 gal | $11,470 | 16.8% | $3.70
  4. Pennsylvania | 2,400 gal | $8,160 | 11.9% | $3.40
  5. Georgia | 1,800 gal | $6,120 | 9.0% | $3.40
  6. South Carolina | 1,200 gal | $4,080 | 6.0% | $3.40
  7. North Carolina | 1,100 gal | $3,740 | 5.5% | $3.40
  8. Virginia | 820 gal | $2,870 | 4.2% | $3.50
- Footer: Total row

**Product Split Cards (2 cards side-by-side)**
- Diesel: 18,420 gal, $64,470, 94.2% of spend
- DEF: 1,240 gal, $3,880, 5.8% of spend

---

## TAB 3: EFFICIENCY (initially hidden)

**Efficiency Metric Cards (6 cards)**
Grid: `repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;`

1. Miles Traveled: blue border, "245,680 mi" (large), "Source: Samsara GPS" (text-muted, italic), truck icon
2. Fleet MPG: green border, "6.42 MPG" (large, green), "↑ 3% vs last quarter" (text-secondary)
3. Cost Per Mile: amber border, "$0.28/mi" (large, monospace), "Fuel cost only" (text-muted)
4. Fill-Ups: blue border, "87" (large), "Avg 6.2 per truck/month"
5. Avg Gal/Fill-Up: purple border, "211.7 gal" (large), "Per fill-up average"
6. Avg Discount/Gal: green border, "$0.04/gal" (large, green, monospace), "Fleet card savings"

**Per-Truck Efficiency Table**
- Title: "Truck Efficiency Breakdown"
- Columns: Truck | Miles (Samsara) | Gallons | MPG | Cost/Mile | Fill-Ups | Avg Gal/Fill
- 4 rows:
  1. T-101 | 68,200 mi | 5,120 gal | 6.21 MPG | $0.29 | 24 | 213.3
  2. T-102 | 62,400 mi | 4,680 gal | 6.54 MPG | $0.27 | 22 | 212.7
  3. T-103 | 59,800 mi | 4,420 gal | 6.48 MPG | $0.27 | 21 | 210.5
  4. T-104 | 55,280 mi | 4,200 gal | 6.38 MPG | $0.28 | 20 | 210.0
- MPG color coding: ≥6.5 green, 6.0-6.49 amber, <6.0 red

---

## TAB 4: PRICE ANALYSIS (initially hidden)

**Average Price Trend (CSS-based)**
- Title: "Avg Price Per Gallon Trend"
- Simple horizontal bars for each month (last 6 months):
  - Aug 2025: $3.42, Sep: $3.38, Oct: $3.45, Nov: $3.52, Dec: $3.58, Jan 2026: $3.50
- Bars proportional to value range ($3.30-$3.60)

**Price by State Table**
- Title: "Current Avg Price by State"
- Columns: State | Avg $/Gal | vs Fleet Avg | Last Purchase
- 8 rows with price comparison:
  - NJ: $3.50, +$0.00 (neutral), Jan 28
  - FL: $3.60, +$0.10 (red), Jan 26
  - NY: $3.70, +$0.20 (red), Jan 25
  - PA: $3.40, -$0.10 (green), Jan 24
  - GA: $3.40, -$0.10 (green), Jan 22
  - SC: $3.40, -$0.10 (green), Jan 20
  - NC: $3.40, -$0.10 (green), Jan 18
  - VA: $3.50, +$0.00 (neutral), Jan 15
- Fleet average shown as info box above table: "Fleet Avg: $3.50/gal"

**IFTA Tax Adjustment Section**
- Card with amber left border
- Title: "IFTA Tax Impact by State"
- Columns: State | IFTA Rate | Tax/Gallon After Adj | Effective $/Gal
- 5 rows showing tax-adjusted pricing
- Footer link: "View Full IFTA Report →"

---

## TRUCK DRILL-DOWN VIEW

Below the tabs, add a hidden section (`display: none` by default) that represents the truck drill-down:
- "Back to All Trucks" button at top (btn btn-outline, with arrow-left icon)
- Truck header: "T-101 — Fuel Details" with truck badge
- Repeat stat cards but filtered for T-101 only
- Filtered transaction table showing only T-101 rows (8 rows)
- Add a note comment in HTML: `<!-- Drill-down: toggled visible when user clicks a truck filter -->`

---

**Styling notes:**
- Page-specific CSS in `<style>` tag for: Samsara status banner, filter row, stat card grid, tab bar, bar chart, drill-down section. Target 120-150 lines.
- Samsara banner: blue-dim background (rgba of blue at 8%), 2px solid var(--blue) border
- Bar chart bars: `display: flex; flex-direction: column; justify-content: flex-end;` with height percentages
- Filter dropdowns: match design system select styling
- Money values in tables: monospace
- Drill-down section: bordered card with dashed top border to visually distinguish
  </action>
  <verify>
Open `mockups/web-tms-redesign/fuel.html` in a browser. Verify:
1. Page loads without console errors
2. Samsara blue banner shows truck count and miles
3. 4 filter dropdowns in a row
4. 6 stat cards with colored left borders
5. 4 segmented pill tabs visible
6. OVERVIEW: 20+ row fuel transaction table with pagination
7. Click Analytics → monthly bar chart, state distribution table, product split cards
8. Click Efficiency → 6 metric cards including Samsara source, per-truck efficiency table
9. Click Price Analysis → price trend, price by state with comparison, IFTA tax adjustment
10. Drill-down section exists in HTML (hidden)
11. Theme toggle works on all tabs
  </verify>
  <done>fuel.html exists with Samsara status banner, 4 filter dropdowns, 6 stat cards, 4 analytics tabs fully populated (Overview with 20+ transaction rows, Analytics with bar chart and state breakdown, Efficiency with 6 metrics and per-truck table, Price Analysis with trends and IFTA tax adjustment), truck drill-down section, and working theme toggle</done>
</task>

<task type="auto">
  <name>Task 2: Create ifta.html with state mileage and tax calculation tables</name>
  <files>mockups/web-tms-redesign/ifta.html</files>
  <action>
Create `ifta.html` by copying the app shell from `base-template.html`. Set title to "Horizon Star TMS — IFTA" and mark the IFTA nav item as `active`.

Inside `<div class="page-content">`, build the complete IFTA page.

**Reference production structure (lines 21098-21292 of index.html) for layout fidelity.**

---

## PAGE HEADER

- Title: "IFTA Reporting" with map-pin icon
- Right side: "Generate Report" button (btn btn-primary) and "Export CSV" button (btn btn-secondary)

## QUARTER / YEAR SELECTOR ROW

Horizontal flex row:
- Quarter selector: 4 pill-style buttons — "Q1" (active, highlighted), "Q2", "Q3", "Q4"
- Year dropdown: select with options 2026 (selected), 2025, 2024
- Fleet MPG input: labeled input field showing "6.42" with label "Fleet MPG"

## AUTO-CALCULATED MPG INFO BOX

Blue info banner (same pattern as Samsara card in fuel — blue-dim background, blue border):
- Calculator icon
- "Auto-Calculated MPG: 6.42" (bold)
- "Based on 245,680 miles / 38,260 gallons (Samsara GPS + Fuel Card data)"
- Badge: "Samsara Verified" (green badge)

## SUMMARY STAT CARDS (7 cards)

Grid: `repeat(auto-fit, minmax(160px, 1fr)); gap: 16px;`
Each card: bg-card, padding 16px, border-radius, colored left border

1. Total Miles: blue border, "245,680" (large, bold), map-pin icon
2. Fleet MPG: green border, "6.42" (large, green), fuel icon
3. Taxable Gallons: amber border, "38,260" (large, monospace), calculator icon
4. Fuel Purchased: blue border, "18,420 gal" (large), droplet icon
5. Tax Owed: red border, "$4,218.40" (large, red, monospace), arrow-up icon
6. Tax Credit: green border, "$3,642.80" (large, green, monospace), arrow-down icon
7. Net Tax Due: bold card with emphasis — amber border, "$575.60" (large, amber, monospace, bold), receipt icon

---

## IFTA CALCULATION TABLE (main table)

- Section title: "IFTA Tax Calculation by State"
- **Exact columns from production:** State | Miles | % of Miles | Taxable Gal | Fuel Purchased | Net Taxable | Tax Rate | Tax Due
- 10 state rows with realistic data:
  1. New Jersey | 52,400 | 21.3% | 8,163 | 4,200 | 3,963 | $0.0450 | $178.34
  2. Florida | 48,200 | 19.6% | 7,509 | 3,800 | 3,709 | $0.0362 | $134.27
  3. New York | 38,600 | 15.7% | 6,015 | 3,100 | 2,915 | $0.0800 | $233.20
  4. Pennsylvania | 28,400 | 11.6% | 4,424 | 2,400 | 2,024 | $0.0741 | $149.98
  5. Georgia | 22,800 | 9.3% | 3,553 | 1,800 | 1,753 | $0.0313 | $54.87
  6. South Carolina | 16,200 | 6.6% | 2,524 | 1,200 | 1,324 | $0.0200 | $26.48
  7. North Carolina | 14,800 | 6.0% | 2,306 | 1,100 | 1,206 | $0.0382 | $46.07
  8. Virginia | 10,400 | 4.2% | 1,620 | 820 | 800 | $0.0262 | $20.96
  9. Maryland | 8,200 | 3.3% | 1,278 | 680 | 598 | $0.0365 | $21.83
  10. Delaware | 5,680 | 2.3% | 885 | 420 | 465 | $0.0220 | $10.23
- **Footer row (bold):** Totals | 245,680 | 100.0% | 38,260 | 18,420 | — | — | $875.60 (this is gross tax before credits; net = $575.60 after credits)
- Color coding: Positive Net Taxable = red (owe tax), Negative = green (credit)
- Tax Rate column: monospace, 4 decimal places
- % of Miles: 1 decimal place

---

## FUEL BY STATE TABLE

- Section title: "Fuel Purchases by State"
- Columns: State | Gallons Purchased | Avg $/Gal | Total Spent | % of Fleet Fuel
- 10 rows matching the states above with fuel purchase data
- Footer: Total row with fleet totals

---

## TAX CREDIT BREAKDOWN

Card with green left border:
- Title: "Tax Credits"
- Table: State | Gallons Over-Purchased | Tax Rate | Credit Amount
- Show 4-5 states where fuel purchased > taxable gallons (credit states)
- Footer: Total Credits: $3,642.80

---

## NET TAX SUMMARY BOX

Prominent card at bottom:
- Background: amber-dim (rgba of amber at 8%)
- Border: 2px solid var(--amber)
- Layout: flex row, space-between
- Left: "Net IFTA Tax Due" (large heading)
- Right: "$575.60" (36px, bold, var(--amber), monospace)
- Below: "Tax Owed: $4,218.40 − Tax Credits: $3,642.80 = Net Due: $575.60"

---

**Styling notes:**
- Page-specific CSS in `<style>` tag for: quarter selector pills, MPG info box, calculation table emphasis, net tax summary box. Target 80-100 lines.
- Quarter pills: same pill-style as tab buttons
- Calculation table: slightly larger than standard (font-size 14px) for readability
- Tax Rate column: monospace with 4 decimal places
- Net Tax Summary: prominent placement with amber treatment
- All money values: monospace
  </action>
  <verify>
Open `mockups/web-tms-redesign/ifta.html` in a browser. Verify:
1. Page loads without console errors
2. Quarter selector with Q1 active, Year dropdown, Fleet MPG input
3. Blue auto-calculated MPG info box with Samsara Verified badge
4. 7 summary stat cards with colored left borders
5. IFTA Calculation table has exact columns: State, Miles, % of Miles, Taxable Gal, Fuel Purchased, Net Taxable, Tax Rate, Tax Due
6. 10 state rows with realistic tax rates
7. Footer row with totals
8. Fuel-by-state table with 10 rows
9. Tax Credit breakdown card
10. Net Tax Summary box with amber styling showing $575.60
11. Theme toggle works
  </verify>
  <done>ifta.html exists with quarter/year selector, auto-calculated MPG info box, 7 summary stat cards, IFTA calculation table with exact production columns and 10 states, fuel-by-state table, tax credit breakdown, net tax summary box, and working theme toggle</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Fuel Tracking mockup with Samsara status banner, 4 filter dropdowns, 6 stat cards, 4 fully populated analytics tabs (Overview with 20+ transaction rows, Analytics with bar chart and state breakdown, Efficiency with Samsara metrics and per-truck table, Price Analysis with trends and IFTA tax adjustment), and truck drill-down section. IFTA mockup with quarter/year selector, auto-calculated MPG info box, 7 stat cards, 10-state IFTA calculation table with exact production columns, fuel-by-state table, tax credit breakdown, and net tax summary box.</what-built>
  <how-to-verify>
1. Open `mockups/web-tms-redesign/fuel.html` in your browser
2. Check blue Samsara status banner at top
3. Verify 4 filter dropdowns (Truck, State, Product, Driver)
4. Verify 6 stat cards with colored left borders
5. OVERVIEW: Scroll through 20+ fuel transaction rows with pagination
6. Click "Analytics" — verify monthly bar chart, state distribution table, product split cards
7. Click "Efficiency" — verify 6 metric cards (Miles from Samsara, MPG, Cost/Mile, Fill-Ups, Avg Gal, Discount), per-truck table
8. Click "Price Analysis" — verify price trend, price-by-state comparison, IFTA tax adjustment card
9. Open `mockups/web-tms-redesign/ifta.html`
10. Verify quarter selector (Q1 active), year dropdown, Fleet MPG input
11. Verify blue MPG info box with "Samsara Verified" badge
12. Verify 7 summary stat cards
13. Verify IFTA calculation table: State, Miles, % of Miles, Taxable Gal, Fuel Purchased, Net Taxable, Tax Rate, Tax Due — 10 states
14. Verify fuel-by-state table and tax credit breakdown
15. Verify amber Net Tax Summary box showing $575.60
16. Toggle dark/light theme on both pages
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- [ ] fuel.html loads in browser without console errors
- [ ] Samsara blue banner with truck count and miles
- [ ] 4 filter dropdowns in horizontal row
- [ ] 6 stat cards (Total Diesel, Diesel Cost, Avg $/Gal, Total Savings, Total DEF, Total Cost)
- [ ] 4 segmented pill tabs with JavaScript switching
- [ ] Overview: 20+ row transaction table with pagination
- [ ] Analytics: Monthly bar chart, state distribution table, product split cards
- [ ] Efficiency: 6 metric cards including Samsara source, per-truck efficiency table with MPG color coding
- [ ] Price Analysis: Price trend, price-by-state comparison, IFTA tax adjustment section
- [ ] Truck drill-down section exists (hidden by default)
- [ ] ifta.html loads in browser without console errors
- [ ] Quarter pills (Q1 active), year dropdown, Fleet MPG input
- [ ] Blue auto-calculated MPG info box with Samsara Verified badge
- [ ] 7 summary stat cards (Total Miles, Fleet MPG, Taxable Gal, Fuel Purchased, Tax Owed, Tax Credit, Net Tax Due)
- [ ] IFTA calculation table with exact columns: State, Miles, % of Miles, Taxable Gal, Fuel Purchased, Net Taxable, Tax Rate, Tax Due
- [ ] 10 state rows with realistic data and tax rates
- [ ] Fuel-by-state table with 10 rows
- [ ] Tax credit breakdown card
- [ ] Net Tax Summary box (amber styling, $575.60)
- [ ] Theme toggle works on both pages
- [ ] shared.css referenced in both files
</verification>

<success_criteria>
Fuel tracking mockup faithfully reproduces the production fuel page with 4 analytics tabs, Samsara integration status, filter controls, stat cards, and truck drill-down. IFTA mockup reproduces the state-by-state mileage and tax calculation tables with exact production columns, quarter/year selector, and net tax summary. Both pages use Phase 6 design system with working light/dark toggle.
</success_criteria>

<output>
After completion, create `.planning/phases/10-operations-admin-pages/10-01-SUMMARY.md`
</output>
