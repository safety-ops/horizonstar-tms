---
phase: 12-core-dispatch-pages
plan: 02
type: execute
wave: 2
depends_on: [12-01]
files_modified: [index.html]
autonomous: true

must_haves:
  truths:
    - "Dashboard stat cards (Revenue, Expenses, Net Profit) use design system .stat-card styling with colored stat-icon elements instead of inline border-left"
    - "Dashboard Quick View hero section uses design system tokens for all spacing, typography, and colors"
    - "Dashboard section headers (OTHER METRICS, DIRECT TRIP EXPENSES, FUEL TRACKING, KPIs, TOP PERFORMERS, PAYMENT COLLECTION, COST TRENDS) use .section-title class with appropriate color modifier"
    - "Dashboard KPI grid and metric cells use design system tokens for consistent styling"
    - "Period selector buttons, year dropdown, and month dropdown use design system tokens"
    - "All existing functionality preserved: period filtering, year selection, export, refresh, task widget interactions"
  artifacts:
    - path: "index.html"
      provides: "Restyled renderDashboard() and renderTasksWidget() functions"
      contains: "section-title"
  key_links:
    - from: "index.html renderDashboard()"
      to: "assets/css/design-system.css"
      via: "CSS class references"
      pattern: "stat-card|section-title|metric-cell"
---

<objective>
Restyle the Dashboard page (renderDashboard and renderTasksWidget functions) to use mockup design system styling. Replace inline styles with design system CSS classes and tokens while preserving all existing DOM structure, JavaScript logic, and interactive behavior.

Purpose: Dashboard is the most-used page in the TMS. Applying the design system makes it visually consistent with the approved mockup while keeping all functionality intact.

Output: Updated renderDashboard() and renderTasksWidget() in index.html with design system classes replacing inline styles.
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-core-dispatch-pages/12-CONTEXT.md
@.planning/phases/12-core-dispatch-pages/12-RESEARCH.md
@mockups/web-tms-redesign/dashboard.html
@assets/css/design-system.css
@index.html (lines 14086-14598 for renderDashboard and renderTasksWidget)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restyle Dashboard top section — header, tasks widget, recent trips, and top stat cards</name>
  <files>index.html</files>
  <action>
  In renderDashboard() (starts at line 14086) and renderTasksWidget() (starts at line 14546), apply the following changes. CRITICAL: Only change visual styling (CSS classes, inline style values). Do NOT change any JavaScript logic, onclick handlers, data calculations, or conditional rendering.

  **1. Period selector buttons (line ~14252):**
  Replace inline button styles with design system tokens. Each button still uses inline styles (they're dynamically generated), but update the hardcoded values:
  - Active: `background:var(--primary);color:white;border-color:var(--primary)` (keep as-is, already uses tokens)
  - Inactive: ensure `border-radius:var(--radius);` instead of `6px`, and `font-size:var(--text-sm)` instead of `13px`

  **2. Top stat cards (lines ~14266-14270):**
  Replace the inline `border-left:4px solid` pattern on stat cards with design system stat-icon approach per mockup:
  - Revenue card: Replace `style="border-left:4px solid var(--green)"` with class and internal structure. Change from `<div class="stat-card" style="border-left:4px solid var(--green)"><div class="label">Revenue Generated</div><div class="value">` to `<div class="stat-card"><div class="stat-icon green"><i data-lucide="dollar-sign" class="ico"></i></div><div class="stat-label">Revenue Generated</div><div class="stat-value">`
  - Expenses card: Same pattern but with `stat-icon red` and `trending-down` icon
  - Net Profit card: Same pattern but with conditional `stat-icon green` or `stat-icon red`, remove inline background color (the design system .stat-card handles background)

  **3. Tasks widget (renderTasksWidget, line ~14546):**
  - Keep the entire structure as-is. It already uses cards, badges, and design system colors well.
  - Only change: Replace hardcoded `font-size:12px` and `font-size:13px` with `font-size:var(--text-xs)` and `font-size:var(--text-sm)` respectively
  - Replace `border-radius:8px` with `border-radius:var(--radius)` on task item divs

  **4. Recent Trips table (line ~14263):**
  - Already well-structured with card, table-wrapper, table. No structural changes needed.
  - Replace hardcoded `padding:40px` on empty state with `padding:var(--spacing-10)`

  IMPORTANT constraints from CONTEXT.md:
  - Do NOT restructure the dashboard grid layout
  - Do NOT add new card wrappers where production doesn't have them
  - Only style existing elements, do NOT add elements from mockup that production doesn't render
  - Preserve all onclick handlers exactly
  </action>
  <verify>
  1. Search for `stat-icon green` in renderDashboard — should find it on Revenue card
  2. Search for `stat-icon red` in renderDashboard — should find it on Expenses card
  3. Search for `border-left:4px solid` in renderDashboard section — should NOT find it on top stat cards (may still exist elsewhere in dashboard)
  4. All onclick handlers in renderDashboard are preserved unchanged
  </verify>
  <done>
  Dashboard top section (period buttons, stat cards, tasks widget, recent trips) uses design system stat-card classes with stat-icon elements instead of inline border-left styling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Restyle Dashboard remaining sections — Quick View, metrics, KPIs, payments, cost trends</name>
  <files>index.html</files>
  <action>
  Continue in renderDashboard() applying design system styling to the remaining sections (lines ~14273-14543). Again, ONLY change visual styling, not logic.

  **1. Quick View hero section (lines ~14307-14348):**
  - Replace hardcoded `font-size:11px` with `font-size:var(--text-xs)`, `font-size:28px` with `font-size:var(--text-3xl)`, `font-size:10px` with `font-size:10px` (keep as is, no design token for 10px)
  - Replace `font-weight:700` with `font-weight:var(--weight-bold)`
  - Replace `letter-spacing:0.5px` — keep as-is (no token)
  - Replace `text-transform:uppercase` — keep as-is (standard CSS)
  - Replace `border-radius:12px` with `border-radius:var(--radius-lg)` and `border-radius:6px` with `border-radius:var(--radius)`
  - Add `font-family:var(--font-mono)` to the large metric values (CPM, RPM, etc.)
  - Keep all the rgba() background colors for the hero gradient sections (these are intentional semi-transparent overlays, not replaceable with tokens)

  **2. Other Metrics + Expenses section (lines ~14351-14391):**
  - Replace each `<h3 style="margin-bottom:16px;color:var(--blue);border-bottom:2px solid var(--blue);padding-bottom:8px">` with `<h3 class="section-title blue">`
  - Same for red (EXPENSES), amber (FUEL), purple (KPIs), green (TOP PERFORMERS), blue (PAYMENT COLLECTION)
  - Replace `font-size:14px` with `font-size:var(--text-sm)` in metric grids
  - Replace `font-weight:600` with `font-weight:var(--weight-semibold)`
  - Replace `border-radius:8px` with `border-radius:var(--radius)` in metric cells
  - Replace `padding:12px` with `padding:var(--spacing-3)` and `padding:16px` with `padding:var(--spacing-4)`

  **3. KPIs section (lines ~14415-14425):**
  - Replace inline KPI cell styles with appropriate design tokens
  - Each KPI cell: `background:var(--bg-app);padding:var(--spacing-3);border-radius:var(--radius);text-align:center`
  - Labels: `font-size:var(--text-xs);color:var(--text-muted)`
  - Values: `font-size:var(--text-lg);font-weight:var(--weight-bold)`

  **4. Top Performers section (lines ~14428-14436):**
  - Apply same design token substitutions for font-sizes, paddings, border-radii

  **5. Payment Collection section (lines ~14440-14449):**
  - Apply design token substitutions for payment cards

  **6. Cost Trends section (lines ~14452-14543):**
  - Replace `border-radius:12px` with `border-radius:var(--radius-lg)` on trend cards
  - Replace hardcoded font sizes with design tokens
  - Keep SVG sparklines exactly as-is (they use actual color values for SVG rendering which is correct)
  - Replace section header with `.section-title` class

  IMPORTANT: The Cost Trends section generates SVG sparklines with `fill=` and `stroke=` attributes that use var() CSS references. These MUST be preserved exactly as they are — SVG fill/stroke with CSS variables is the correct pattern.
  </action>
  <verify>
  1. Search for `section-title blue` in renderDashboard — should find it on OTHER METRICS and PAYMENT COLLECTION headers
  2. Search for `section-title red` in renderDashboard — should find it on DIRECT TRIP EXPENSES header
  3. Search for `section-title amber` in renderDashboard — should find it on FUEL TRACKING header
  4. Search for `section-title purple` in renderDashboard — should find it on KPIs header
  5. Search for `section-title green` in renderDashboard — should find it on TOP PERFORMERS header
  6. All onclick handlers and data calculations preserved
  7. SVG sparkline generation code unchanged
  </verify>
  <done>
  All dashboard sections (Quick View, metrics, KPIs, performers, payments, cost trends) use design system tokens and .section-title classes instead of inline style definitions. All interactive behavior preserved.
  </done>
</task>

</tasks>

<verification>
1. renderDashboard function still works correctly (no JavaScript errors introduced)
2. All 9 dashboard sections rendered: Tasks widget, Recent trips, Stat cards, Quick View, Other Metrics + Expenses, Fuel Tracking, KPIs + Performers, Payment Collection, Cost Trends
3. Period filter buttons still work (changeDashboardPeriod)
4. Year and month selectors still work
5. Export and Refresh buttons preserved
6. Task checkboxes and edit buttons still work
7. Recent trips table rows still clickable (viewTrip)
8. No hardcoded hex colors introduced (only CSS variables)
</verification>

<success_criteria>
- Dashboard renders identically in both themes with design system styling
- All 9 sections use design system tokens for colors, fonts, spacing, borders
- Section headers use .section-title class with color modifiers
- Top stat cards use .stat-card + .stat-icon pattern
- Zero JavaScript logic changes
- All interactive elements (buttons, selects, checkboxes, links) fully functional
</success_criteria>

<output>
After completion, create `.planning/phases/12-core-dispatch-pages/12-02-SUMMARY.md`
</output>
