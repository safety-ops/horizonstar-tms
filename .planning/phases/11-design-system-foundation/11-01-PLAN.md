---
phase: 11-design-system-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - assets/css/design-system.css
  - index.html
autonomous: true

must_haves:
  truths:
    - "design-system.css contains all CSS tokens from mockup shared.css (colors, typography, spacing, shadows, borders, transitions)"
    - "Toast notification styles (success/error/warning/info) render correctly in both themes"
    - "Spinner/loading styles work correctly in both themes"
    - "Accessibility styles (skip-link, sr-only, focus-visible, reduced-motion) are preserved"
    - "All hex colors in the <style> block (lines 35-8049) are replaced with var() references"
    - "Theme toggle switches all <style> block colors correctly between light and dark"
  artifacts:
    - path: "assets/css/design-system.css"
      provides: "Complete design system with tokens, components, toasts, spinners, accessibility, pagination"
    - path: "index.html"
      provides: "Style block (lines 35-8049) with var() references instead of hex colors"
  key_links:
    - from: "assets/css/design-system.css"
      to: "index.html"
      via: "CSS custom properties consumed by inline styles"
      pattern: "var\\(--"
    - from: "assets/css/design-system.css"
      to: "assets/css/base.css"
      via: "design-system.css takes precedence, base.css kept as fallback"
---

<objective>
Complete the design-system.css file by adding missing production styles (toasts, spinners, loading states, accessibility, pagination) and replace all hardcoded hex colors in the index.html `<style>` block with CSS variable references.

Purpose: Establishes the complete CSS foundation so that all global components use design tokens and respond correctly to theme toggle. This is the prerequisite for hex replacement in the JS render functions (plans 02-03).

Output: A complete design-system.css (all tokens + all component styles) and a hex-free `<style>` block in index.html.
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-design-system-foundation/11-CONTEXT.md
@.planning/phases/11-design-system-foundation/11-RESEARCH.md
@assets/css/design-system.css
@assets/css/base.css
@mockups/web-tms-redesign/shared.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add missing production styles to design-system.css</name>
  <files>assets/css/design-system.css</files>
  <action>
Read base.css and identify styles that exist there but NOT in design-system.css. These must be migrated into design-system.css so that when base.css is eventually removed, nothing breaks.

Missing styles to add to design-system.css (append after the responsive section at bottom):

1. **Toast notifications** (base.css lines 272-301):
   - `.toast` base style with fixed positioning, bg-card, shadow, border-left accent, animation
   - `.toast.success`, `.toast.error`, `.toast.warning`, `.toast.info` color variants
   - `@keyframes slideInRight` animation
   - Use design tokens: `var(--bg-card)`, `var(--text-primary)`, `var(--radius)`, `var(--shadow-lg)`, `var(--green)`, `var(--red)`, `var(--amber)`, `var(--blue)`

2. **Spinner/loading styles** (base.css lines 208-266):
   - `.spinner`, `.spinner-inline`, `.spinner-sm` with spin animation
   - `.loading`, `.loading-state` flex containers
   - `@keyframes spin` rotation
   - `@keyframes skeleton-pulse` for skeleton loading
   - `.skeleton-line` with pulse animation

3. **Accessibility styles** (base.css lines 76-132):
   - `.skip-link` and `.skip-link:focus` for keyboard nav
   - `.sr-only` screen reader only
   - `:focus-visible` outline using `var(--green)` instead of `var(--primary)`
   - `.aria-live-region` offscreen live region
   - `@media (prefers-reduced-motion: reduce)` motion reduction

4. **Pagination controls** (not in base.css but needed for GLC-10):
   Add pagination styles that match the mockup pattern:
   ```css
   .pagination {
     display: flex;
     align-items: center;
     justify-content: center;
     gap: 4px;
     padding: 16px 0;
   }
   .pagination-btn {
     display: inline-flex;
     align-items: center;
     justify-content: center;
     min-width: 36px;
     height: 36px;
     padding: 0 8px;
     border-radius: var(--radius-sm);
     border: 1px solid var(--border);
     background: var(--bg-card);
     color: var(--text-secondary);
     font-size: var(--text-sm);
     font-weight: var(--weight-medium);
     cursor: pointer;
     transition: all var(--transition-fast);
   }
   .pagination-btn:hover {
     background: var(--bg-card-hover);
     color: var(--text-primary);
     border-color: var(--text-muted);
   }
   .pagination-btn.active {
     background: var(--green);
     color: white;
     border-color: var(--green);
   }
   .pagination-btn:disabled {
     opacity: 0.4;
     cursor: not-allowed;
   }
   .pagination-info {
     font-size: var(--text-sm);
     color: var(--text-muted);
     padding: 0 8px;
   }
   ```

5. **Additional utility classes from base.css** not yet in design-system.css:
   - `.block { display: block; }`, `.inline { display: inline; }`, `.inline-block { display: inline-block; }`
   - `.font-normal { font-weight: var(--weight-normal); }`
   - `.m-0 { margin: 0; }`, `.p-0 { padding: 0; }`
   - `.w-auto { width: auto; }`
   - `.cursor-pointer { cursor: pointer; }`, `.cursor-not-allowed { cursor: not-allowed; }`
   - `.text-left { text-align: left; }`

IMPORTANT:
- Do NOT remove or modify any existing styles in design-system.css
- Append new styles after the existing responsive section (after line ~1514)
- Use design system token names (var(--green), var(--radius), etc.), NOT old names (var(--primary), var(--success))
- Keep the toast animation name `slideInRight` matching what ui.js expects
  </action>
  <verify>
Grep design-system.css for key class names:
- `grep -c '\.toast' assets/css/design-system.css` should be >= 5
- `grep -c '\.spinner' assets/css/design-system.css` should be >= 3
- `grep -c '\.skip-link' assets/css/design-system.css` should be >= 1
- `grep -c '\.pagination' assets/css/design-system.css` should be >= 4
- `grep -c 'slideInRight' assets/css/design-system.css` should be >= 1
- `grep -c 'prefers-reduced-motion' assets/css/design-system.css` should be >= 1
  </verify>
  <done>design-system.css contains all component styles from base.css plus new pagination styles, using design token variable names throughout.</done>
</task>

<task type="auto">
  <name>Task 2: Replace all hex colors in index.html style block (lines 35-8049)</name>
  <files>index.html</files>
  <action>
The `<style>` block in index.html (lines 35-8049) contains ~229 hardcoded hex colors. Replace ALL of them with CSS variable references using this mapping:

**Color mapping (hex -> var):**

Green family:
- `#22c55e` -> `var(--green)` (or `var(--primary-500)`)
- `#16a34a` -> `var(--primary-600)` or `var(--green)` depending on context
- `#15803d` -> `var(--primary-700)`
- `#166534` -> `var(--primary-800)`
- `#14532d` -> `var(--primary-900)`
- `#4ade80` -> `var(--primary-400)`
- `#059669` -> use `var(--green)` or define --emerald if needed
- `#047857` -> similar emerald shade, use closest token
- `#10b981` -> accent green, use `var(--green)` or `var(--accent)` if in gradient
- `#d1fae5`, `#dcfce7`, `#bbf7d0`, `#f0fdf4` -> `var(--green-dim)` or `var(--primary-50/100/200/300)` spectrum
- `#6ee7b7`, `#34d399` -> lighter greens, use primary spectrum vars

Red family:
- `#ef4444` -> `var(--red)`
- `#dc2626` -> `var(--red)` (light theme red)
- `#991b1b` -> darker red, define `--red-dark` if needed or use `var(--red)`
- `#f87171` -> lighter red, use `var(--red)` with opacity or define
- `#fee2e2`, `#fecaca` -> `var(--red-dim)`

Amber/Yellow family:
- `#f59e0b` -> `var(--amber)`
- `#d97706` -> `var(--amber)` (light theme amber)
- `#fef3c7`, `#fffbeb`, `#fefce8` -> `var(--amber-dim)`
- `#fb923c`, `#ea580c` -> orange, use `var(--amber)` as closest

Blue family:
- `#3b82f6` -> `var(--blue)`
- `#2563eb` -> `var(--blue)` (light theme blue)
- `#1d4ed8`, `#1e40af` -> darker blue, use `var(--blue)` or define
- `#dbeafe`, `#bfdbfe` -> `var(--blue-dim)`

Purple family:
- `#8b5cf6` -> `var(--purple)`
- `#7c3aed` -> `var(--purple)` or darker variant
- `#4c1d95`, `#6b21a8` -> very dark purple, use `var(--purple)` or define

Gray/Neutral family:
- `#ffffff` -> `var(--bg-card)` for backgrounds, keep `#ffffff` or `white` for text-on-colored-buttons
- `#f8fafc`, `#f8f9fa` -> `var(--bg-app)`
- `#f1f5f9`, `#f3f4f6` -> `var(--bg-card-hover)` or `var(--bg-tertiary)`
- `#e2e8f0`, `#e5e7eb` -> `var(--bg-elevated)` or `var(--bg-darker)`
- `#1e293b`, `#334155` -> dark backgrounds, use `var(--bg-card)` in dark context
- `#0f172a`, `#111827` -> `var(--text-primary)` when used as text
- `#475569`, `#4b5563` -> `var(--text-secondary)`
- `#64748b`, `#6b7280` -> `var(--text-secondary)` or `var(--secondary)`
- `#94a3b8`, `#9ca3af` -> `var(--text-muted)`

**Context-aware rules:**
- `background: #hex` -> use `var(--bg-*)` tokens
- `color: #hex` -> use `var(--text-*)` tokens for text, `var(--green/red/amber/blue)` for colored text
- `border: * #hex` or `border-color: #hex` -> use `var(--border)` for neutral, color token for accent
- `box-shadow: * rgba(...)` -> these are OK to leave as rgba() since they're opacity-based, but if they reference a brand color, use the dim token
- `linear-gradient(...)` with hex colors -> replace hex values inside gradients with var() tokens
- `#fff` / `#ffffff` used as text color on colored buttons -> keep as `white` (keyword) since it doesn't change with theme
- Dark theme specific selectors (`.dark-theme`, `body.dark-theme`) -> use the dark theme token values where appropriate

**IMPORTANT constraints:**
- Do NOT change any HTML structure, class names, or JS logic
- Do NOT change any CSS property names or selectors
- Only change the VALUES (hex colors) to var() references
- If a hex color doesn't have an obvious token mapping, add the needed token to the `:root` block at the top of the `<style>` section, referencing design-system.css tokens
- Keep `rgba()` values that use custom opacity -- they don't need replacement unless they could be tokenized
- The meta tag `<meta name="theme-color" content="#22c55e">` on line 10 is fine to keep as-is (it's metadata, not CSS)
  </action>
  <verify>
Run these checks:
- `awk 'NR>=35 && NR<=8049' index.html | grep -oE '#[0-9a-fA-F]{6}\b' | wc -l` should be under 20 (allowing a few in gradients or meta-like values that are intentional)
- `awk 'NR>=35 && NR<=8049' index.html | grep -c 'var(--'` should be significantly higher than before (was ~400, should be 600+)
- Theme toggle should switch ALL style-block colors -- no "stuck" colors visible in dark theme
  </verify>
  <done>The index.html style block (lines 35-8049) has all hex colors replaced with CSS variable references, and the style block exclusively uses design system tokens for color values.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. Open index.html in browser -- page loads without CSS errors in console
2. Toggle dark theme via the theme button -- all style-block-driven colors change
3. Toast notifications (trigger via any save action) show correct colors in both themes
4. Loading spinners appear correctly
5. Pagination controls render (visible on Orders, Trips tables)
6. Skip-link appears on Tab key press
7. No visual regressions in sidebar, header, modals, tables, buttons, badges, cards, forms
</verification>

<success_criteria>
- design-system.css contains ALL global component styles: tokens, layout, sidebar, header, modals, tables, forms, buttons, badges, cards, toasts, spinners, accessibility, pagination, icons, utilities, responsive
- Less than 20 hex color literals remain in the index.html `<style>` block (only in non-theme-critical positions like gradients or print styles)
- Theme toggle correctly switches all colors in the style block
</success_criteria>

<output>
After completion, create `.planning/phases/11-design-system-foundation/11-01-SUMMARY.md`
</output>
