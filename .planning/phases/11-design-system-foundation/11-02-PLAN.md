---
phase: 11-design-system-foundation
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - index.html
autonomous: true

must_haves:
  truths:
    - "All hex colors in the <style> block (lines 35-8049) are replaced with var() references"
    - "Theme toggle switches all <style> block colors correctly between light and dark"
    - "No visual regressions in any CSS-driven styles (sidebar, header, modals, tables, buttons, badges, forms, cards)"
  artifacts:
    - path: "index.html"
      provides: "Style block (lines 35-8049) with var() references instead of hex colors"
  key_links:
    - from: "assets/css/design-system.css"
      to: "index.html"
      via: "CSS custom properties consumed by inline styles"
      pattern: "var\\(--"
    - from: "assets/css/design-system.css"
      to: "assets/css/base.css"
      via: "design-system.css takes precedence, base.css kept as fallback"
---

<objective>
Replace all hardcoded hex colors in the index.html `<style>` block (lines 35-8049) with CSS variable references.

Purpose: The style block contains ~229 hardcoded hex colors that don't respond to theme toggle. Replacing them with var() references from design-system.css makes the entire CSS layer theme-aware. This is the prerequisite for hex replacement in the JS render functions (plans 03-04).

Output: A hex-free `<style>` block in index.html.
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-design-system-foundation/11-CONTEXT.md
@.planning/phases/11-design-system-foundation/11-01-SUMMARY.md
@assets/css/design-system.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace all hex colors in index.html style block (lines 35-8049)</name>
  <files>index.html</files>
  <action>
The `<style>` block in index.html (lines 35-8049) contains ~229 hardcoded hex colors. Replace ALL of them with CSS variable references using this mapping:

**Color mapping (hex -> var):**

Green family:
- `#22c55e` -> `var(--green)` (or `var(--primary-500)`)
- `#16a34a` -> `var(--primary-600)` or `var(--green)` depending on context
- `#15803d` -> `var(--primary-700)`
- `#166534` -> `var(--primary-800)`
- `#14532d` -> `var(--primary-900)`
- `#4ade80` -> `var(--primary-400)`
- `#059669` -> use `var(--green)` or define --emerald if needed
- `#047857` -> similar emerald shade, use closest token
- `#10b981` -> accent green, use `var(--green)` or `var(--accent)` if in gradient
- `#d1fae5`, `#dcfce7`, `#bbf7d0`, `#f0fdf4` -> `var(--green-dim)` or `var(--primary-50/100/200/300)` spectrum
- `#6ee7b7`, `#34d399` -> lighter greens, use primary spectrum vars

Red family:
- `#ef4444` -> `var(--red)`
- `#dc2626` -> `var(--red)` (light theme red)
- `#991b1b` -> darker red, define `--red-dark` if needed or use `var(--red)`
- `#f87171` -> lighter red, use `var(--red)` with opacity or define
- `#fee2e2`, `#fecaca` -> `var(--red-dim)`

Amber/Yellow family:
- `#f59e0b` -> `var(--amber)`
- `#d97706` -> `var(--amber)` (light theme amber)
- `#fef3c7`, `#fffbeb`, `#fefce8` -> `var(--amber-dim)`
- `#fb923c`, `#ea580c` -> orange, use `var(--amber)` as closest

Blue family:
- `#3b82f6` -> `var(--blue)`
- `#2563eb` -> `var(--blue)` (light theme blue)
- `#1d4ed8`, `#1e40af` -> darker blue, use `var(--blue)` or define
- `#dbeafe`, `#bfdbfe` -> `var(--blue-dim)`

Purple family:
- `#8b5cf6` -> `var(--purple)`
- `#7c3aed` -> `var(--purple)` or darker variant
- `#4c1d95`, `#6b21a8` -> very dark purple, use `var(--purple)` or define

Gray/Neutral family:
- `#ffffff` -> `var(--bg-card)` for backgrounds, keep `#ffffff` or `white` for text-on-colored-buttons
- `#f8fafc`, `#f8f9fa` -> `var(--bg-app)`
- `#f1f5f9`, `#f3f4f6` -> `var(--bg-card-hover)` or `var(--bg-tertiary)`
- `#e2e8f0`, `#e5e7eb` -> `var(--bg-elevated)` or `var(--bg-darker)`
- `#1e293b`, `#334155` -> dark backgrounds, use `var(--bg-card)` in dark context
- `#0f172a`, `#111827` -> `var(--text-primary)` when used as text
- `#475569`, `#4b5563` -> `var(--text-secondary)`
- `#64748b`, `#6b7280` -> `var(--text-secondary)` or `var(--secondary)`
- `#94a3b8`, `#9ca3af` -> `var(--text-muted)`

**Context-aware rules:**
- `background: #hex` -> use `var(--bg-*)` tokens
- `color: #hex` -> use `var(--text-*)` tokens for text, `var(--green/red/amber/blue)` for colored text
- `border: * #hex` or `border-color: #hex` -> use `var(--border)` for neutral, color token for accent
- `box-shadow: * rgba(...)` -> OK to leave as rgba() since they're opacity-based, but if they reference a brand color, use the dim token
- `linear-gradient(...)` with hex colors -> replace hex values inside gradients with var() tokens
- `#fff` / `#ffffff` used as text color on colored buttons -> keep as `white` (keyword) since it doesn't change with theme
- Dark theme specific selectors (`.dark-theme`, `body.dark-theme`) -> use the dark theme token values where appropriate

**IMPORTANT constraints:**
- Do NOT change any HTML structure, class names, or JS logic
- Do NOT change any CSS property names or selectors
- Only change the VALUES (hex colors) to var() references
- If a hex color doesn't have an obvious token mapping, add the needed token to the `:root` block at the top of the `<style>` section, referencing design-system.css tokens
- Keep `rgba()` values that use custom opacity -- they don't need replacement unless they could be tokenized
- The meta tag `<meta name="theme-color" content="#22c55e">` on line 10 is fine to keep as-is (it's metadata, not CSS)
  </action>
  <verify>
Run these checks:
- `awk 'NR>=35 && NR<=8049' index.html | grep -oE '#[0-9a-fA-F]{6}\b' | wc -l` should be under 20 (allowing a few in gradients or meta-like values that are intentional)
- `awk 'NR>=35 && NR<=8049' index.html | grep -c 'var(--'` should be significantly higher than before (was ~400, should be 600+)
- Theme toggle should switch ALL style-block colors -- no "stuck" colors visible in dark theme
  </verify>
  <done>The index.html style block (lines 35-8049) has all hex colors replaced with CSS variable references, and the style block exclusively uses design system tokens for color values.</done>
</task>

</tasks>

<verification>
After task completes:
1. Open index.html in browser -- page loads without CSS errors in console
2. Toggle dark theme via the theme button -- all style-block-driven colors change
3. No visual regressions in sidebar, header, modals, tables, buttons, badges, cards, forms
4. Less than 20 hex color literals remain in the style block
</verification>

<success_criteria>
- Less than 20 hex color literals remain in the index.html `<style>` block (only in non-theme-critical positions like gradients or print styles)
- Theme toggle correctly switches all colors in the style block
- No CSS parse errors in browser console
</success_criteria>

<output>
After completion, create `.planning/phases/11-design-system-foundation/11-02-SUMMARY.md`
</output>
