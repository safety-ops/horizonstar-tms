---
phase: 16-design-token-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - assets/css/variables.css
  - assets/css/base.css
autonomous: false

must_haves:
  truths:
    - "Every gradient CSS variable in variables.css resolves to a single solid color value -- zero linear-gradient or radial-gradient functions remain"
    - "Shadow variables provide exactly 3 depth levels (sm, md, lg) with neutral rgba(0,0,0,...) colors -- no color-tinted shadows"
    - "Glass variables resolve to solid equivalents (no blur, no transparency effects) -- glass-bg is solid bg-card, glass-blur is none, glass-border is solid border"
    - "Glow shadow variables resolve to none -- no colored glow effects"
    - "Dark theme background has no radial gradient pseudo-element overlay -- body.dark-theme::before block is deleted"
    - "Both light and dark themes render clean solid backgrounds with no gradient functions anywhere in variables.css"
  artifacts:
    - path: "assets/css/variables.css"
      provides: "All CSS design tokens for both themes"
      contains_none: ["linear-gradient", "radial-gradient", "blur("]
    - path: "assets/css/base.css"
      provides: "Base styles, utilities, and functional animations"
      unchanged: true
  key_links:
    - from: "assets/css/variables.css"
      to: "index.html (120+ gradient var references)"
      via: "CSS custom property inheritance"
      pattern: "var\\(--gradient-"
      note: "Variable NAMES preserved, VALUES changed to solid colors -- index.html references still resolve"
    - from: "assets/css/variables.css"
      to: "index.html (8 glass/glow var references)"
      via: "CSS custom property inheritance"
      pattern: "var\\(--glass-|var\\(--shadow-glow"
      note: "Variable NAMES preserved with safe fallback values (solid bg, none) -- index.html references still resolve"
---

<objective>
Clean up all CSS design tokens in variables.css to produce only solid colors, clean shadows, and flat backgrounds. Replace gradient variables with solid color equivalents, simplify the shadow system to 3 depth levels, neutralize glass/glow variables with safe fallbacks, and remove the dark theme radial gradient pseudo-element.

Purpose: Establish a clean, flat CSS token foundation before Phase 17 strips inline effects from index.html. Tokens must output professional, Stripe-dashboard-tier values.

Output: A variables.css file with zero gradient functions, zero blur effects, zero glow shadows, and a clean 3-level shadow system. base.css remains unchanged (it has no glass/glow references).
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-design-token-cleanup/16-RESEARCH.md
@assets/css/variables.css
@assets/css/base.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace gradient variables and simplify shadow system in variables.css</name>
  <files>assets/css/variables.css</files>
  <action>
Edit assets/css/variables.css to make the following changes in the :root (light theme) block:

**Gradient replacements (TOK-01)** -- Replace each gradient value with a solid color. Keep the variable NAMES unchanged:

```css
--accent-gradient: #22c55e;
--gradient-primary: #22c55e;
--gradient-primary-hover: #16a34a;
--gradient-secondary: #3b82f6;
--gradient-warning: #f59e0b;
--gradient-danger: #ef4444;
--gradient-purple: #8b5cf6;
--gradient-sidebar: #1a2f2a;
--gradient-card: var(--bg-card);
```

**Shadow simplification (TOK-02)** -- Replace the 13 shadow variables with 3 core levels + backward-compatible mappings. Remove the entire existing shadow block (lines 41-53) and replace with:

```css
/* Shadows - 3 depth levels */
--shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
--shadow-md: 0 2px 4px rgba(0,0,0,0.08);
--shadow-lg: 0 4px 8px rgba(0,0,0,0.10);

/* Backward-compatible shadow mappings */
--shadow-xs: var(--shadow-sm);
--shadow: var(--shadow-sm);
--shadow-xl: var(--shadow-lg);
--shadow-card: var(--shadow-sm);
--shadow-card-hover: var(--shadow-md);
--shadow-float: var(--shadow-lg);
--shadow-inset: none;
```

**Glass variable neutralization (TOK-03)** -- Replace glass effect values with safe solid equivalents (do NOT delete -- index.html references these 4 times):

```css
/* Glass Effect - neutralized to solid values */
--glass-bg: var(--bg-card);
--glass-border: var(--border);
--glass-blur: none;
```

**Glow shadow neutralization (TOK-03)** -- Replace glow shadow values with none (do NOT delete -- index.html references these 4 times):

The 3 glow variables (--shadow-glow-green, --shadow-glow-blue, --shadow-inner-glow) should NOT appear as separate declarations. They are simply omitted from the new shadow block above. But since index.html uses them, add them after the shadow-inset line:

```css
--shadow-glow-green: none;
--shadow-glow-blue: none;
--shadow-inner-glow: none;
```

**Dark theme changes** -- In the body.dark-theme block:

1. Replace --gradient-card line (currently a linear-gradient) with:
   ```css
   --gradient-card: var(--bg-card);
   ```

2. Replace shadow overrides with clean 3-level system + mappings:
   ```css
   --shadow-sm: 0 1px 2px rgba(0,0,0,0.3);
   --shadow-md: 0 2px 4px rgba(0,0,0,0.4);
   --shadow-lg: 0 4px 8px rgba(0,0,0,0.5);
   --shadow-card: var(--shadow-sm);
   --shadow-card-hover: var(--shadow-md);
   ```
   Remove --shadow, --shadow-xl lines from dark theme (they inherit via var() mappings from :root).

3. Replace glass overrides with solid equivalents:
   ```css
   --glass-bg: var(--bg-card);
   --glass-border: var(--border);
   ```

**Important constraints:**
- Do NOT change any non-effect variables (colors, borders, backgrounds, text, radius, layout, animation)
- Do NOT rename any variables -- keep all names, only change values
- Do NOT modify base.css in this task (it has zero glass/glow references)
  </action>
  <verify>
Run these verification commands -- all must return 0 results:

```bash
grep "linear-gradient\|radial-gradient" assets/css/variables.css
grep "blur(" assets/css/variables.css
```

Run these to confirm structure is intact:

```bash
grep -c "^  --" assets/css/variables.css
# Should be in the range of 55-70 (variables still present)

grep "gradient-primary" assets/css/variables.css
# Should show the variable with solid color value #22c55e

grep "shadow-sm\|shadow-md\|shadow-lg" assets/css/variables.css
# Should show exactly 3 core definitions in :root + 3 in dark-theme
```
  </verify>
  <done>
- Every gradient variable in :root resolves to a single solid color (no gradient functions)
- Shadow system has exactly 3 core levels (sm, md, lg) with neutral rgba colors
- All old shadow names mapped to the 3 levels via var() references
- Glass variables resolve to solid bg-card/border/none values
- Glow shadow variables resolve to none
- Dark theme gradient-card is solid, shadows are 3-level, glass is solid
- No linear-gradient, radial-gradient, or blur() functions remain in variables.css
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove dark theme background glow pseudo-element</name>
  <files>assets/css/variables.css</files>
  <action>
Delete the entire body.dark-theme::before rule block from variables.css. This is the block at the end of the file (approximately lines 127-139) that creates a radial gradient glow overlay on dark theme backgrounds:

```css
/* Dark theme background gradient effect */
body.dark-theme::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  background: radial-gradient(circle at 30% 20%, rgba(34, 197, 94, 0.06) 0%, transparent 50%),
              radial-gradient(circle at 80% 80%, rgba(16, 185, 129, 0.04) 0%, transparent 50%);
}
```

Delete the entire block including the comment. After deletion, the file should end after the closing `}` of the `body.dark-theme` block.

**Why this is safe:** The ::before pseudo-element is z-index: 0 with pointer-events: none -- it's purely decorative. Removing it has no functional impact. The dark theme will use the solid --bg-primary color (#0c1520) with no overlays.
  </action>
  <verify>
Run these verification commands:

```bash
grep "dark-theme::before" assets/css/variables.css
# Should return 0 results

grep "radial-gradient" assets/css/variables.css
# Should return 0 results

# Confirm file ends cleanly
tail -5 assets/css/variables.css
# Should show the closing } of body.dark-theme block
```
  </verify>
  <done>
- The body.dark-theme::before rule block is completely removed from variables.css
- No radial-gradient functions remain anywhere in variables.css
- Dark theme will render clean solid background with no glow overlay
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Visual verification of both themes</name>
  <what-built>
All CSS design tokens cleaned up in variables.css:
- 9 gradient variables replaced with solid colors
- 13 shadow variables simplified to 3-level system with backward-compatible mappings
- 3 glass variables neutralized to solid equivalents
- 3 glow shadow variables neutralized to none
- Dark theme gradient-card flattened to solid
- Dark theme ::before glow pseudo-element removed
- base.css left unchanged (no glass/glow references found)
  </what-built>
  <how-to-verify>
1. Open index.html in browser
2. Light theme check:
   - Cards should have solid white backgrounds (no gradient sheen)
   - Buttons should show solid green/blue/etc (no gradient)
   - Sidebar should be solid dark green (no gradient)
   - Shadows should be subtle and neutral (no colored glow)
   - No glass/frosted effects visible
3. Toggle to dark theme (click theme toggle):
   - Background should be solid dark (#0c1520) with NO green glow overlay
   - Cards should be solid dark (#151f2c) with no gradient
   - Shadows should be slightly stronger but still neutral
   - No glass effects visible
4. Check that functional elements still work:
   - Toast notifications still appear and slide in
   - Loading spinners still animate
   - Hover states on cards/buttons still respond
5. Check multiple pages (Dashboard, Orders, Trips) to confirm consistency
  </how-to-verify>
  <resume-signal>Type "approved" if both themes look clean and professional, or describe any visual issues you see</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete, run these comprehensive checks:

```bash
# 1. Zero gradients in variables.css
grep -c "linear-gradient\|radial-gradient" assets/css/variables.css
# Expected: 0

# 2. Zero blur effects
grep -c "blur(" assets/css/variables.css
# Expected: 0

# 3. Zero glow in variable VALUES (glow in names like --shadow-glow-green is OK)
grep "glow" assets/css/variables.css | grep -v "^  --shadow-glow.*: none"
# Expected: 0 results

# 4. Dark theme pseudo-element gone
grep "dark-theme::before" assets/css/variables.css
# Expected: 0 results

# 5. base.css unchanged (no glass/glow refs existed, no changes needed)
grep "glass-\|glow" assets/css/base.css
# Expected: 0 results

# 6. Shadow system has exactly 3 core levels in light theme
grep "^  --shadow-sm:\|^  --shadow-md:\|^  --shadow-lg:" assets/css/variables.css | head -3
# Expected: 3 lines with rgba(0,0,0,...) values

# 7. All gradient variable names still present (backward compat)
grep "gradient-primary\|gradient-secondary\|gradient-warning\|gradient-danger\|gradient-purple\|gradient-sidebar\|gradient-card\|accent-gradient" assets/css/variables.css
# Expected: 9+ lines (names preserved with solid values)
```
</verification>

<success_criteria>
1. `grep "linear-gradient\|radial-gradient\|blur(" assets/css/variables.css` returns 0 matches
2. variables.css contains exactly 3 core shadow definitions (sm, md, lg) per theme with neutral rgba colors
3. All gradient variable NAMES are preserved (backward compatible with 120+ index.html references)
4. Glass/glow variable NAMES are preserved with safe values (backward compatible with 8 index.html references)
5. Dark theme ::before pseudo-element is completely removed
6. base.css is unmodified
7. Visual verification confirms clean, flat, professional appearance in both light and dark themes
</success_criteria>

<output>
After completion, create `.planning/phases/16-design-token-cleanup/16-01-SUMMARY.md`
</output>
