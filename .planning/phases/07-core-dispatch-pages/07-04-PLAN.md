---
phase: 07-core-dispatch-pages
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - mockups/web-tms-redesign/trip-detail.html
autonomous: false

must_haves:
  truths:
    - "Trip Detail shows back button and trip title (e.g., TRIP 3 - 77 - 2025)"
    - "Financials card displays Load Revenue, Broker Fees, Local Fees, Driver Cut, Net Profit, CPM, RPM"
    - "Vehicles are grouped by direction with colored section headers matching production colors"
    - "At least 3 direction sections are shown with vehicle rows"
    - "Expenses table shows category-grouped expense items"
    - "Dispatcher Pricing Guidance widget shows calculated pricing metrics"
    - "Light/dark theme toggle works and all elements render correctly in both themes"
  artifacts:
    - path: "mockups/web-tms-redesign/trip-detail.html"
      provides: "Complete Trip Detail mockup with financials, vehicles by direction, and expenses"
      min_lines: 300
  key_links:
    - from: "trip-detail.html"
      to: "shared.css"
      via: "link rel stylesheet"
      pattern: 'href="./shared.css"'
    - from: "trip-detail.html"
      to: "base-template.html"
      via: "copied app shell (sidebar + header + page-content)"
      pattern: "class=\"app-layout\""
---

<objective>
Create the Trip Detail mockup page with financials card, vehicles grouped by direction (colored sections), expenses table, and dispatcher pricing guidance widget.

Purpose: The Trip Detail page is the drill-down view from the Trips list. It shows the full financial breakdown of a single trip, all vehicles organized by travel direction with colored headers, and expense tracking. This mockup must reproduce the exact layout from the production `viewTrip()` function.

Output: `mockups/web-tms-redesign/trip-detail.html` — a complete, standalone HTML file showing the detail view for a single trip with all production sections.
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-core-dispatch-pages/07-CONTEXT.md
@.planning/phases/07-core-dispatch-pages/07-RESEARCH.md
@mockups/web-tms-redesign/shared.css
@mockups/web-tms-redesign/base-template.html
@mockups/web-tms-redesign/component-showcase.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create trip-detail.html with financials, vehicle directions, and expenses</name>
  <files>mockups/web-tms-redesign/trip-detail.html</files>
  <action>
Create `trip-detail.html` by copying the app shell from `base-template.html`. Set page title to "Horizon Star TMS — Trip Detail", header title to "Trip Detail", and mark the Trips nav item as `active`.

Inside `<div class="page-content">`, build these sections matching the production `viewTrip()` function:

**Section 1: Back Button + Trip Title**
- A "Back to Trips" link/button with left arrow icon (lucide arrow-left)
- Title: "TRIP 3 - 77 - 2025" (large, bold)
- Subtitle: "Truck 77 — John Smith — Jan 10 - Jan 15, 2025"
- Status badge: COMPLETED (badge-green)
- Use flex row with title on left, status badge on right

**Section 2: Trip Financials Card**
Card with header "Trip Financials".
Responsive grid (7 metric cells, `grid-template-columns: repeat(auto-fit, minmax(140px, 1fr))`):
- Load Revenue: $8,450.00 (green)
- Broker Fees: -$475.00 (red)
- Local Fees: -$175.00 (red)
- Clean Revenue: $7,800.00 (blue)
- Driver Cut (32%): -$2,496.00 (amber)
- Net Profit: $3,250.00 (green, larger font)
- Margin: 38.5% (blue)

Second row of per-mile metrics:
- CPM (Cost Per Mile): $1.82
- RPM (Revenue Per Mile): $3.47
- Margin Per Mile: $1.65
- Total Miles: 2,435

Each metric: label on top (small, text-secondary), value below (large, bold, colored). Use `text-align: center; padding: 12px;` per cell.

**Section 3: Dispatcher Pricing Guidance Widget**
Card with header "Dispatcher Pricing Guidance".
Show calculated pricing recommendations in a 2-column grid:
- Left column — Per-Car Pricing:
  - Minimum PPC: $850.00 (red/warning threshold)
  - Target PPC: $1,050.00 (green/target)
  - Premium PPC: $1,250.00 (blue/premium)
  - Current Avg PPC: $987.50
- Right column — Trip Economics:
  - Break-Even Revenue: $5,176.00
  - Target Revenue (35% margin): $7,963.00
  - Current Revenue: $8,450.00 (green, above target)
  - Capacity Remaining: 3 slots

Use colored indicators: green if above target, amber if near break-even, red if below.

**Section 4: Vehicles by Direction (colored sections)**
This is the main content area. Vehicles are grouped by travel direction, each with a colored header bar and vehicle table below it.

Show 3 direction sections with vehicles:

**Direction 1: HOME TO CA** (#22c55e green)
- Colored header bar: `background: #22c55e; color: white; padding: 12px 16px; font-weight: 700; border-radius: 8px 8px 0 0; display: flex; justify-content: space-between;`
  - Left: "HOME TO CA (5 cars)"
  - Right: "Revenue: $6,250.00 | Clean Revenue: $5,875.00"
- Table below with border matching color (`border: 2px solid #22c55e; border-top: none; border-radius: 0 0 8px 8px;`)
- Columns: Order # | Vehicle | Origin | Destination | Pay Type | Broker Fee | Local Fee | Price | Status
- 5 rows:
  1. ORD-2024-001 / 2024 Toyota Camry / Los Angeles, CA / Fresno, CA / COD (badge-green) / $75.00 / $25.00 / $1,150.00 / DELIVERED (badge-green)
  2. ORD-2024-015 / 2023 Honda Civic / San Diego, CA / Sacramento, CA / COP (badge-blue) / $50.00 / $30.00 / $950.00 / DELIVERED (badge-green)
  3. ORD-2024-027 / 2025 Ford Mustang / Phoenix, AZ / San Jose, CA / BILL (badge-red) / $125.00 / $0.00 / $1,350.00 / IN_TRANSIT (badge-blue)
  4. ORD-2024-033 / 2022 Tesla Model 3 / Tucson, AZ / Oakland, CA / COD (badge-green) / $100.00 / $50.00 / $1,275.00 / DELIVERED (badge-green)
  5. ORD-2025-003 / 2024 BMW X5 / Albuquerque, NM / Bakersfield, CA / COD (badge-green) / $90.00 / $25.00 / $1,525.00 / PENDING (badge-amber)

**Direction 2: CA TO HOME** (#22c55e green — same color as HOME_TO_CA in production)
- Header: "CA TO HOME (4 cars)"
- Right: "Revenue: $3,800.00 | Clean Revenue: $3,540.00"
- 4 rows with different vehicles heading back east

**Direction 3: FL TO CA** (#f59e0b amber)
- Header: "FL TO CA (3 cars)"
- Right: "Revenue: $2,850.00 | Clean Revenue: $2,625.00"
- 3 rows of Florida to California vehicles

Use realistic vehicle data for each direction section. Each table uses `.table-container` and `.table` classes.

**Section 5: Trip Expenses Table**
Card with header "Trip Expenses" and "Add Expense" primary button.
Table columns: Category | Description | Date | Amount | Receipt
6-8 expense rows grouped by category:
- Fuel: "Fuel - Pilot Travel Center, Barstow CA" / 2025-01-11 / $485.00 / View link
- Fuel: "Fuel - Love's, Amarillo TX" / 2025-01-12 / $520.00 / View link
- Tolls: "PA Turnpike" / 2025-01-10 / $145.00 / —
- Tolls: "NJ Turnpike" / 2025-01-10 / $87.50 / —
- Maintenance: "Tire rotation, truck 77" / 2025-01-14 / $180.00 / View link
- Parking: "Overnight - TA Truck Stop, Nashville" / 2025-01-11 / $45.00 / —
- Permits: "Overweight permit - California" / 2025-01-13 / $125.00 / View link

Totals row at bottom: Total Expenses: $1,587.50

Amount column: right-aligned, monospaced. Category column: bold, use category-colored badges.

**Spacing:** 24px between each major section. Use `margin-bottom: 24px` consistently.
  </action>
  <verify>
Open `mockups/web-tms-redesign/trip-detail.html` in a browser. Verify:
1. Page loads without errors
2. Back button and trip title are visible
3. Financials card shows 7+ metrics with colored values
4. Pricing guidance widget shows min/target/premium pricing
5. 3 direction sections render with colored headers
6. Vehicle tables appear under each direction header
7. Expenses table shows categorized expense items
8. Theme toggle works
9. Dollar amounts are monospaced
  </verify>
  <done>trip-detail.html exists with financials card, pricing guidance, 3 colored vehicle direction sections, and expenses table, using shared.css classes exclusively with realistic data</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Trip Detail mockup for "TRIP 3 - 77 - 2025" with financials card (revenue, fees, driver cut, profit, CPM/RPM), dispatcher pricing guidance widget, 3 colored vehicle direction sections (HOME TO CA, CA TO HOME, FL TO CA), and a categorized expenses table.</what-built>
  <how-to-verify>
1. Open `mockups/web-tms-redesign/trip-detail.html` in your browser
2. Verify back button and "TRIP 3 - 77 - 2025" title with COMPLETED badge
3. Check financials card: Load Revenue, Broker Fees, Local Fees, Clean Revenue, Driver Cut, Net Profit, Margin
4. Check pricing guidance: Minimum/Target/Premium PPC and trip economics
5. Verify 3 direction sections with colored headers (green for HOME_TO_CA and CA_TO_HOME, amber for FL_TO_CA)
6. Check vehicle rows under each direction with order details
7. Verify expenses table with categorized items and total
8. Toggle dark/light theme — colored direction headers should remain visible in both
9. Confirm layout matches your current Trip Detail page structure
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- [ ] trip-detail.html loads in browser without console errors
- [ ] Back button and trip title present
- [ ] Financials card shows all key metrics
- [ ] Pricing guidance widget shows calculated values
- [ ] 3+ direction sections with colored headers
- [ ] Vehicle tables under each direction
- [ ] Expenses table with categorized rows and total
- [ ] shared.css is the only stylesheet
- [ ] Theme toggle works
- [ ] All dollar amounts monospaced and right-aligned
</verification>

<success_criteria>
Trip Detail mockup faithfully reproduces the production Trip Detail view with financials, pricing guidance, colored vehicle direction sections, and expenses, reskinned with Phase 6 design system, with realistic data and working theme toggle.
</success_criteria>

<output>
After completion, create `.planning/phases/07-core-dispatch-pages/07-04-SUMMARY.md`
</output>
